invert algorithm cacm november knapp shaman 